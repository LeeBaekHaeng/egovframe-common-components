<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MapTeamDAO">

	<select id="selectMapTeamList"
		parameterType="egovframework.com.dam.map.tea.service.MapTeamVO"
		resultType="egovframework.com.dam.map.tea.service.MapTeamVO">
<![CDATA[
SELECT  /* MapTeamDAO.selectMapTeamList */
        A.ORGNZT_ID
      , A.ORGNZT_NM
      , DATE_FORMAT(A.CL_DE,'%Y-%m-%d')	CL_YMD
      , A.KNWLDG_URL					KNO_URL
]]>
		<include refid="selectMapTeamFromWhere"></include>
<![CDATA[
  LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
]]>
	</select>

	<select id="selectMapTeamTotCnt"
		parameterType="egovframework.com.dam.map.tea.service.MapTeamVO"
		resultType="int">
<![CDATA[ 
SELECT /* MapTeamDAO.selectMapTeamTotCnt */
       COUNT(*) TOT_CNT
]]>
		<include refid="selectMapTeamFromWhere"></include>
	</select>

	<sql id="selectMapTeamFromWhere">
<![CDATA[
  FROM COMTNDAMMAPTEAM A
 WHERE 1 = 1
]]>
		<choose>
			<when
				test="@egovframework.com.cmm.util.EgovMybatisUtil@isEquals(searchCondition, '1')">
<![CDATA[
   AND BINARY(A.ORGNZT_NM) LIKE CONCAT('%', #{searchKeyword}, '%')
]]>
			</when>
			<when
				test="@egovframework.com.cmm.util.EgovMybatisUtil@isEquals(searchCondition, '2')">
<![CDATA[
   AND BINARY(A.ORGNZT_ID) LIKE CONCAT('%', #{searchKeyword}, '%')
]]>
			</when>
			<otherwise>
<![CDATA[
   /* otherwise */
]]>
			</otherwise>
		</choose>
	</sql>

	<select id="selectMapTeamDetail"
		parameterType="egovframework.com.dam.map.tea.service.MapTeamVO"
		resultType="egovframework.com.dam.map.tea.service.MapTeamVO">
<![CDATA[
SELECT /* MapTeamDAO.selectMapTeamDetail */
       A.ORGNZT_ID
     , A.ORGNZT_NM
     , A.CL_DE
     , DATE_FORMAT(A.CL_DE,'%Y-%m-%d')	CL_YMD
     , A.KNWLDG_URL						KNO_URL
  FROM COMTNDAMMAPTEAM A
 WHERE A.ORGNZT_ID = #{orgnztId}
]]>
	</select>

	<insert id="insertMapTeam"
		parameterType="egovframework.com.dam.map.tea.service.MapTeamVO">
<![CDATA[
INSERT /* MapTeamDAO.insertMapTeam 지식URL 등록 */
  INTO COMTNDAMMAPTEAM (
       ORGNZT_ID
     , ORGNZT_NM
     , CL_DE
     , KNWLDG_URL
     , LAST_UPDT_PNTTM
     , LAST_UPDUSR_ID
     ) VALUES (
       #{orgnztId}
     , #{orgnztNm}
     , #{clYmd}
     , #{knoUrl}
     , sysdate()
     , #{frstRegisterId}
     )
]]>
	</insert>

	<update id="updateMapTeam">
<![CDATA[
            UPDATE  COMTNDAMMAPTEAM 
               SET  ORGNZT_ID         = #{orgnztId}
                 ,  ORGNZT_NM         = #{orgnztNm}
                 ,  CL_DE  		  = #{clYmd}
                 ,  KNWLDG_URL           = #{knoUrl}
                 ,  LAST_UPDT_PNTTM = sysdate()
                 ,  LAST_UPDUSR_ID    = #{lastUpdusrId}
             WHERE  ORGNZT_ID         = #{orgnztId} 
]]>
	</update>

	<delete id="deleteMapTeam">
<![CDATA[
            DELETE  FROM COMTNDAMMAPTEAM 
            WHERE   ORGNZT_ID = #{orgnztId}
]]>
	</delete>


</mapper>